### 代码整洁之道
### 序
"小处诚实非小事".

相对于任何宏伟愿景,对细节的关注甚至时更为关键的专业性基础.首先,开发者通过小型实践获得可用于大型实践的技能和信用度.其次,宏大建筑
中最细小的部分,比如关不紧的门、有点儿没铺平的地板,甚至时凌乱的桌面,都会将震哥哥大局的魅力毁灭殆尽.这就是整洁之所系.

对于软件而言,百分之八十或更多的工作量集中再我们美其名曰"维护"的事情上:其实就是修修补补.

### 前言
衡量代码质量的唯一有效标准: WTF/min

如果在那道正确的门(code review)后做补救工作?答案是:技艺.

习艺之要有二: 知和行.你应当习得有关原则、模式和实践的知识,穷尽应知之事,并且要对其了如执掌,通过刻苦实践掌握它.

学习整洁代码很难.它可不止于要求你掌握原则和模式.你得在这上面花功夫.你须自行实践,且体验自己的失败.你须观察他人的实践与失败.你须
看看别人是怎样蹒跚学步,再砖头研究他们的路数.你须看看别人是如何绞尽脑汁做出决策,又是如何为错误决策付出代价.

### 第1章 整洁代码
阅读本书有两种原因: 第一,你是个程序员;第二,你想成为更好的程序员.很好,我们需要更好的程序员.

我们将能说出好代码和糟糕的代码之间的差异,将了解到如何写出好代码,如何将糟糕的代码改成好代码.

#### 1.1 要有代码
我们永远抛不掉代码,因为代码呈现了需求的细节.在某些层面上,这些细节无法被忽略或抽象,必须明确之.将需求明确到机器可以执行的细节程度,
就是编程要做的事.而这种规约正是代码.

记住,代码确然是我们最终用来表达需求的那种语言.我们可以创造各种与需求接近的语言.我们可以创造帮助把需求解析和汇整为正式结构的各种
工具.然而,我们永远无法抛弃必要的精确性--所以代码永存.

#### 1.2 糟糕的代码
我们都曾经瞟一眼自己亲手造成的混乱,决定弃之而不顾,走向新一天.我们都曾经看到自己的烂程序居然能运行,然后断言能运行的烂程序总比什么
都没有强.我们都曾经说过有朝一日再回头清理.当然,在那些日子里,我们都没听过勒布朗法则:稍后等于永不.

#### 1.3 混乱的代价
有些团队在项目初期进展迅速,但有那么一两年的时间却慢如蜗牛.对代码的每次修改都影响到其他两三处代码.修改无小事,每次添加或修改代码,
都得对那堆扭纹柴了然于心,这样才能往上扔更多的扭纹柴.这团乱麻越来越大,无法清理,最后束手无策.

随着混乱的增加,团队生产力也持续下降,趋向于零.当生产力下降时,管理层就只有一件事可做了:增加更多人手到项目中,期望提升生产力.可是新
人不熟悉系统的设计.他们搞不清楚什么样的修改符合设计意图,什么样的修改违背设计意图.而且,他们以及团队中的其他人都背负提升生产力的
可怕压力.于是,他们制造更多的混乱,驱动生产力向零那端不断下降.

##### 1.3.1 华丽新设计
最后,开发团队造反了,他们要求做全新的设计.组建一支新军.剩下老团队和新团队进行竞赛.花时间保持代码整洁不但有关效率,还有关生产.

##### 1.3.2 态度
你是否遇到过某种严重到要花数个星期来做本来只需数小时即可完成的事的混乱状况?你是否见过本来只需做一行修改,结果却涉及上百个模块的情
况?这种事太常见了.

怎么会发生这种事?为什么好代码会这么快就变质成糟糕的代码?理由多得很.我们抱怨需求变化背离了初期设计.我们哀叹进度太紧张,没法干好活.
我们把问题归咎于那些愚蠢的经理、苛求的用户、没用的营销方式和那些电话消毒剂.不过,亲爱的呆伯特,我们是自作自受.我们太不专业了.

这话可不太中听.怎么会是自作自受呢?难道不关需求的事?难道不关进度的事?难道他们就不该负点责吗?

不,经理和营销人员指望从我们这里得到必须的信息,然后才能做出承诺和保证;即使他们没开口问,我们也不该羞于告知自己的想法.用户指望我们
验证需求是否都在系统中实现了.项目经理指望我们遵守进度.我们与项目的规划脱不了干系,对失败负有极大责任:特别是当失败与糟糕的代码有
关时尤为如此!

"且慢!"你说."不听经理的,我会被炒鱿鱼."多半不会.多数经理想要知道实情,即便他们看起来不喜欢实情.多数经理想要好代码,即便他们总是痴
缠于进度.他们会奋力卫护进度和需求:那是他们该干的.你则当以同样的热情卫护代码.

程序员遵从不了解混乱风险的经理的意愿,也是不专业的做法.

##### 1.3.3 谜题
之前的混乱拖了自己的后腿,但开发者们背负期限的压力,只好制造混乱. 制造混乱无助于赶上期限.混乱指挥立刻拖慢你,叫你错过期限.赶上期限
的唯一方法--做得快的唯一方法--就是始终尽可能保持代码整洁.

##### 1.3.4 整洁代码的艺术
写整洁代码,需要遵循大量的小技巧,贯彻刻苦习得的"整洁感".这种"代码感"就是关键所在.有些人生而有之,有些人费点劲才能得到.他不仅让我
们看到代码的优劣,还予我们以借戒规之力化劣为优的攻略.

缺乏"代码感"的程序员,看混乱是混乱,无处着手.有"代码感"的程序员能从混乱中看出其他的可能和变化."代码感"帮助程序员选出最好的方案,并
指导程序员制订修改行为计划,按图索骥.

简言之,编写整洁代码的程序员就像是艺术家,他能用一系列变换把一块白板变作由优秀代码构成的系统.

##### 1.3.5 什么是整洁代码
我喜欢优雅和高效的代码,代码逻辑应当直截了当,叫缺陷难以隐藏;尽量减少依赖关系,使之便于维护;依据某种分层战略完善错误处理代码;性能
调至最优,省得引诱别人做没规矩的优化,搞出一堆混乱来,整洁的代码只做好一件事. ---Bjarne Stroustrup.

整洁的代码简单直接,整洁的代码如同优美的散文.整洁的代码从不隐藏设计者的意图,充满了干净利落的抽象和直截了当的空置语句. 
---Grady Booch

整洁的代码应可由作者之外的开发者阅读和增补.它应有单元测试和验收测试.它使用由意义的命名.它只提供一种而非多种做一件事的途径.它只
有尽量少的依赖关系,且要明确地定义和提供清晰、尽量少的API.代码应通过其表达含义,因为不同的语言导致并非所有必需信息均可用代码自身
清晰表述.

#### 1.4 思想流派
武术家从不认同所谓最好的武术,也不认同所谓绝招.武术大师们常常创建自己的流派,聚徒而授.弟子们沉浸于创始人的授业.他们全心师从某位师
傅,排斥其他师傅.弟子有所成就后,可以转投另一位师傅,扩展自己的知识与技能.有些弟子最终百炼成钢,创出新招数,开宗立派.

#### 1.5 我们是作者
我们是作者.实际上,作者有责任与读者做良好沟通.下次你写代码的时候,记得自己是作者,要为评判你工作的读者写代码.

你该明白了.读与写花费时间的比例超过10:1.写新代码时,我们一直在读旧代码.既然比例如此之高,我们就想让读的过程变得轻松,即便那会使得
编写过程更难.没可能光写不读,所以使之易读实际也使之易写.

这事概不例外.不读周边代码的话没法写代码.编写代码的难度,取决于读周边代码的难度.要想干得快,要想早点昨晚,要想轻松写代码,先让代码易
读吧.

#### 1.6 童子军军规
美国童子军一条简单的军规: 让营地比你来时更干净.

#### 1.7 前传与原则
<<敏捷软件开发:原则、模式与实践>>的前传.

#### 1.8 小结
艺术书并不保证你读过之后能成为艺术家,只能告诉你其他艺术家用过的工具、技术和思维过程.本书同样也不担保让你成为好程序员.它不担保能
给你"代码感".它能做的,只是展示好程序员的思维过程,还有他们使用的技巧、技术和工具.





















